<% name_has_error = business.errors.full_messages_for(:name).any? %>
<% website_has_error = business.errors.full_messages_for(:website).any? %>
<% base_input =
  "w-full rounded-lg bg-gray-50 border px-3 py-2 text-sm text-gray-900 " \
  "placeholder:text-gray-400 outline-none transition " \
  "focus:bg-white focus:ring-4 focus:ring-black/10 focus:border-gray-900" %>
<% input_ok    = "#{base_input} border-gray-200" %>
<% input_error = "#{base_input} border-red-300 focus:ring-red-500/10 focus:border-red-500" %>

<div id="business-form">  
  <%= form_with model: business, class: "space-y-4", data: { controller: "form", turbo_frame: "_top" } do |f| %>
    <%= f.hidden_field :tenant_id, value: @tenant.id %>

    <div class="space-y-2 border-b border-gray-100 pb-3">
      <div class="flex items-center gap-2">
        <%= inline_svg_tag "clipboard.svg", class: "h-4 w-4 text-gray-500" %>
        <h3 class="text-base font-semibold text-gray-900">Business details</h3>
      </div>
      <p class="text-xs text-gray-500">
        Add your website so we can pull service information automatically. We only use this to
        populate your catalog.
      </p>
    </div>

    <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
      <div class="space-y-1">
        <div class="flex items-center justify-between">
          <%= f.label :name, class: "text-xs font-semibold text-gray-900" %>
          <% if name_has_error %>
            <span class="text-[11px] font-medium text-red-600">
              <%= business.errors.full_messages_for(:name).first %>
            </span>
          <% end %>
        </div>

        <%= f.text_field :name,
          placeholder: "Business name",
          class: (name_has_error ? input_error : input_ok)
        %>
      </div>

      <div class="space-y-1">
        <div class="flex items-center justify-between">
          <%= f.label :website, class: "text-xs font-semibold text-gray-900" %>
          <% if website_has_error %>
            <span class="text-[11px] font-medium text-red-600">
              <%= business.errors.full_messages_for(:website).first %>
            </span>
          <% end %>
        </div>

        <%= f.text_field :website,
          placeholder: "example.com",
          class: (website_has_error ? input_error : input_ok)
        %>
      </div>
    </div>
    <div class="flex items-center justify-end">
      <button data-form-target="submit" type="submit" class="inline-flex items-center justify-center rounded-lg bg-gray-900 px-3 py-1.5 text-xs font-semibold text-white hover:bg-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-100">
        Create Business
        <%= inline_svg_tag "tube-spinner.svg", class: "h-5 h-5 hidden text-white fill-current ml-2", data: {"form-target": "spin"}  %>
      </button>
    </div>
  <% end %>
</div>
