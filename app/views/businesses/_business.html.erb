<% business_items = nav_items(business) %>
<% business_active = business_items.any? { |item| nav_active?(item) } %>
<div data-controller="collapse" class="space-y-2">
  <div class="flex items-center justify-between rounded-md px-2.5 py-1.5 hover:bg-gray-50">
    <%= link_to business_bookings_path(business),
      class: "text-xs font-semibold text-gray-700 truncate flex-1 block -my-1.5 py-1.5 -ml-2.5 pl-2.5" do %>
      <%= business.name %>
    <% end %>
    <button
      type="button"
      data-action="click->collapse#toggle"
      data-collapse-target="toggle"
      class="ml-2 inline-flex h-6 w-6 items-center justify-center rounded-md text-gray-500 hover:bg-gray-100 hover:text-gray-700"
      aria-expanded="<%= business_active %>"
      aria-label="Toggle business links"
    >
      <%= inline_svg_tag "cheveron-right.svg", class: "h-3 w-3 transition-transform #{'rotate-90' if business_active}", data: { collapse_target: "icon" } %>
    </button>
  </div>
  <div
    data-collapse-target="content"
    class="space-y-1.5 pl-2 overflow-hidden transition-[max-height,opacity] duration-200 ease-out <%= business_active ? 'max-h-64 opacity-100' : 'max-h-0 opacity-0' %>"
  >
    <% business_items.each do |item| %>
      <% active = nav_active?(item) %>
      <%= link_to item.path, class: nav_item_classes(active) do %>
        <%= inline_svg_tag "#{item.icon}.svg", class: nav_icon_classes(active) %>
        <span class="truncate"><%= item.label %></span>
      <% end %>
    <% end %>
  </div>
</div>
