<% input_base = "mt-2 block w-full rounded-lg border border-gray-300 bg-white px-3 py-2.5 text-sm text-gray-900 shadow-sm placeholder:text-gray-400 focus:border-gray-400 focus:outline-none focus:ring-4 focus:ring-gray-100" %>
<% input_disabled = "bg-gray-100 text-gray-500 cursor-not-allowed" %>

<div class="mb-8">
  <h2 class="text-2xl font-bold text-gray-900">Tell us about yourself</h2>
  <p class="text-gray-500 mt-1">This helps personalize your workspace.</p>
</div>

<%= form_with model: @user, url: onboarding_path(step),
  data: { controller: "form" },
  class: "relative pb-28" do |f| %>

  <!-- CONTENT (no container) -->
  <div class="space-y-8 max-w-3xl">
    <!-- Avatar -->
    <div class="flex items-center gap-6">
      <%= f.file_field :avatar, class: "hidden",
        data: { form_target: "fileInput", action: "change->form#preview" } %>

      <button type="button"
        data-action="click->form#triggerUpload"
        class="group relative rounded-full focus:outline-none focus:ring-4 focus:ring-gray-100">
        <%= image_tag(@user.avatar.attached? ? url_for(@user.avatar) : "avatar-fallback.svg",
          fallback: "avatar-fallback.svg",
          "data-form-target": "preview",
          class: "w-20 h-20 rounded-full object-cover border border-gray-200") %>
        <span class="absolute inset-0 rounded-full bg-black/0 group-hover:bg-black/5"></span>
      </button>

      <div>
        <p class="text-sm font-semibold text-gray-800">Profile photo</p>
        <p class="text-xs text-gray-500">PNG, JPG up to 2MB</p>
      </div>
    </div>

    <!-- Fields -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <%= f.label :name, class: "text-sm font-medium text-gray-700" %>
        <%= f.text_field :name, placeholder: "Your name", class: input_base %>
      </div>

      <div>
        <%= f.label :email, class: "text-sm font-medium text-gray-700" %>
        <%= f.text_field :email, disabled: true, readonly: true,
          class: "#{input_base} #{input_disabled}" %>
      </div>
    </div>
  </div>

  <!-- STICKY FOOTER ACTIONS -->
  <div class="fixed left-0 right-0 bottom-0 md:left-[380px] border-gray-200 backdrop-blur">
    <div class="mx-auto max-w-3xl px-6 md:px-12 py-4 flex justify-end">
      <%= f.submit "Next",
        class: "inline-flex items-center justify-center rounded-lg bg-gray-900 px-6 py-2.5 text-sm font-semibold text-white hover:bg-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-100" %>
    </div>
  </div>
<% end %>
